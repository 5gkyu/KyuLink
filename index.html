<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=5,user-scalable=yes" />  <title>KyuLink</title>
  <meta name="description" content="ãã‚…ãƒ¼ãŒã‚ˆãä½¿ã†ãƒªãƒ³ã‚¯ã¾ã¨ã‚" />
  
  <!-- Favicon: use local image files (favicon.ico, apple-touch-icon, android-chrome) -->
  <link rel="apple-touch-icon" sizes="180x180" href="apple-icon.png" />
  <link rel="icon" type="image/png" sizes="192x192" href="android-chrome-192x192.png" />
  <link rel="icon" type="image/png" sizes="512x512" href="android-chrome-512x512.png" />
  <link rel="shortcut icon" href="favicon.ico" />
  <link rel="manifest" href="manifest.json" />

  <!-- Theme color (åˆéŸ³ãƒŸã‚¯è‰²) -->
  <meta name="theme-color" content="#39C5D6" />
  <meta name="msapplication-TileColor" content="#39C5D6" />
  
  <!-- Open Graph / Facebook -->
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://5gkyu.github.io/KyuLink/" />
  <meta property="og:title" content="KyuLink" />
  <meta property="og:description" content="ãã‚…ãƒ¼ãŒã‚ˆãä½¿ã†ãƒªãƒ³ã‚¯ã¾ã¨ã‚" />
  <meta property="og:image" content="/ogp.png" />
  <meta property="og:image:width" content="1200" />
  <meta property="og:image:height" content="630" />
  <meta property="og:image:alt" content="KyuLink â€” ãã‚…ãƒ¼ãŒã‚ˆãä½¿ã†ãƒªãƒ³ã‚¯ã¾ã¨ã‚" />
  <link rel="image_src" href="/ogp.png" />
  
  <!-- Twitter -->
  <meta property="twitter:card" content="summary_large_image" />
  <meta property="twitter:url" content="https://5gkyu.github.io/KyuLink/" />
  <meta property="twitter:title" content="KyuLink" />
  <meta property="twitter:description" content="ãã‚…ãƒ¼ãŒã‚ˆãä½¿ã†ãƒªãƒ³ã‚¯ã¾ã¨ã‚" />
  <meta property="twitter:image" content="/ogp.png" />
  <meta name="twitter:image:alt" content="KyuLink â€” ãã‚…ãƒ¼ãŒã‚ˆãä½¿ã†ãƒªãƒ³ã‚¯ã¾ã¨ã‚" />
  
  <link rel="stylesheet" href="style.css">
  <style>
    /* When add/edit modal is open, make header visible but disabled (cannot interact) */
    body.modal-add-open header.card {
      pointer-events: none;
      opacity: 0.4;
      filter: blur(1px);
    }
    body.modal-add-open .fab,
    body.modal-add-open .sidebar {
      display: none !important;
    }
    /* Prevent body from scrolling when modal open */
    body.modal-add-open { overflow: hidden; }

    /* Ensure main content sits below the fixed header (uses --hdr-h set by script) */
    .wrap {
      box-sizing: border-box;
      padding-top: calc(var(--hdr-h, 72px) + 16px);
    }
  </style>
    <script>
    (function(){
      let lastH = 0;
      let scheduled = false;
      function updateHeaderHeight(){
        try{
          const header = document.querySelector('header.card');
          if(!header) return;
          const h = header.offsetHeight || 0;
          if(h === lastH) return;
          lastH = h;
          document.documentElement.style.setProperty('--hdr-h', h + 'px');
        }catch(e){console.warn('updateHeaderHeight failed', e)}
      }
      function scheduleUpdate(){ if(scheduled) return; scheduled = true; requestAnimationFrame(()=>{ scheduled = false; updateHeaderHeight(); }); }
      updateHeaderHeight();
      window.addEventListener('resize', scheduleUpdate);
      window.addEventListener('orientationchange', scheduleUpdate);
      if(window.visualViewport){
        try{
          visualViewport.addEventListener('resize', scheduleUpdate);
          // avoid reacting to visualViewport.scroll to prevent layout thrash on mobile
        }catch(e){}
      }
      window.addEventListener('load', ()=> setTimeout(scheduleUpdate,120));
    })();
    </script>
</head>
<body>
  <div id="loadingOverlay" aria-hidden="true">
    <div class="loader">
      <div class="spinner" aria-hidden="true"></div>
      <div class="loader-text">èª­ã¿è¾¼ã¿ä¸­â€¦</div>
    </div>
  </div>
  <div class="wrap">
    <header class="card" role="banner">
      <div class="top-row">
        <div class="search" aria-hidden="false" style="flex:1;min-width:0;margin:0;">
          <input id="q" placeholder="æ¤œç´¢" autocomplete="off" />
          <div class="icon" id="countText" style="font-size:12px;opacity:0.8;">0 ä»¶</div>
        </div>

        <button class="more-btn tag-btn" id="moreTagsBtn" aria-haspopup="dialog" style="flex-shrink:0;margin-left:8px;">ğŸ·ï¸ ã‚¿ã‚°</button>

        <div id="authRight" style="flex-shrink:0;z-index:1010;">
          <div class="user-info-row" id="userInfoBtn" title="ãƒ¦ãƒ¼ã‚¶ãƒ¼è¨­å®š">
            <div class="user-mini-avatar" id="userMiniAvatar">ğŸ‘¤</div>
            <span class="user-info-text" id="userInfoText">ãƒ¦ãƒ¼ã‚¶ãƒ¼: ã‚²ã‚¹ãƒˆ</span>
          </div>
        </div>
      </div>

      <!-- mid-row removed: display-size and sort moved to hamburger menu -->
      <!-- count row (kept outside header for transparent background) -->
    </header>

    <main>
      <div class="list" id="list"></div>
    </main>
  </div>

  <!-- FABãƒœã‚¿ãƒ³ã¯å‰Šé™¤æ¸ˆã¿ - ãƒœãƒˆãƒ ãƒŠãƒ“ã‚’ä½¿ç”¨ -->

  <!-- modal for adding a bookmark -->
  <div class="modal" id="addModal" role="dialog" aria-modal="true">
    <div class="panel" role="document" aria-labelledby="addTitle">
      <h3 id="addTitle">ãƒ–ãƒƒã‚¯ãƒãƒ¼ã‚¯ã‚’è¿½åŠ </h3>

      <div class="form-row">
        <label>URLï¼ˆå¿…é ˆï¼‰</label>
        <div class="form-inline">
          <input id="addUrl" type="url" placeholder="https://example.com" style="flex:1" />
          <button id="pasteUrlBtn" class="small-btn" type="button">URL</button>
          <button id="pasteJsonBtn" class="small-btn" type="button">JSON</button>
        </div>
      </div>

      <div class="form-row">
        <label>ã‚¿ã‚¤ãƒˆãƒ«</label>
        <input id="addTitleInput" type="text" placeholder="è‡ªå‹•å–å¾—ã•ã‚Œã¾ã™" />
      </div>

      <div class="form-row">
        <label>ã‚¢ã‚¤ã‚³ãƒ³ URLï¼ˆä»»æ„ï¼‰</label>
        <input id="addIcon" type="url" placeholder="å¤–éƒ¨ã‚¢ã‚¤ã‚³ãƒ³ URL ã‚’æŒ‡å®šï¼ˆçœç•¥å¯ï¼‰" />
      </div>
      <div class="form-row">
        <label>èª¬æ˜ï¼ˆä»»æ„ï¼‰</label>
        <textarea id="addDesc" rows="2" placeholder="ã‚µã‚¤ãƒˆã®èª¬æ˜"></textarea>
      </div>

      <!-- ãƒ•ã‚©ãƒ«ãƒ€æ©Ÿèƒ½ã‚’å»ƒæ­¢ã—ã¾ã—ãŸ -->

      <div class="form-row">
        <label>ã‚¿ã‚°ï¼ˆã‚«ãƒ³ãƒåŒºåˆ‡ã‚Šã€ä»»æ„ï¼‰</label>
        <input id="addTags" type="text" placeholder="ä¾‹: é–‹ç™º,ãƒ„ãƒ¼ãƒ«" />
        <div id="quickTagsContainer" style="display:flex;flex-wrap:wrap;gap:4px;margin-top:6px;"></div>
      </div>

      <div style="display:flex;gap:8px;justify-content:space-between;margin-top:8px;align-items:center">
        <div style="display:flex;gap:8px;align-items:center">
          <button id="deleteInModal" class="small-btn" type="button" style="background:#e74c3c;color:#fff;border-color:#e74c3c;">å‰Šé™¤</button>
        </div>
        <div style="display:flex;gap:8px;justify-content:flex-end;align-items:center">
          <button id="cancelAdd" class="small-btn" type="button">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
          <button id="saveAdd" class="open-btn" type="button">ä¿å­˜</button>
        </div>
      </div>
    </div>
  </div>

  <!-- modal for full tag selection -->
  <div class="modal" id="tagModal" role="dialog" aria-modal="true">
    <div class="panel">
      <h3>ã‚¿ã‚°ã§çµã‚Šè¾¼ã‚€</h3>
      <div style="margin-bottom:8px"><input id="tagSearch" placeholder="ã‚¿ã‚°ã§æ¤œç´¢" style="width:100%;padding:8px;border-radius:8px;border:1px solid rgba(255,255,255,0.04);background:transparent;color:inherit" /></div>
      <div class="tags-grid" id="modalTags"></div>
      <div style="margin-top:12px;text-align:right"><button id="closeModal">é–‰ã˜ã‚‹</button></div>
    </div>
  </div>

  <!-- ãƒ•ã‚©ãƒ«ãƒ€æ©Ÿèƒ½ã¯å®Œå…¨ã«å‰Šé™¤ã—ã¾ã—ãŸ -->

  <!-- modal for view mode selection -->
  <div class="modal" id="viewModeModal" role="dialog" aria-modal="true">
    <div class="panel" role="document" style="max-width:360px;">
      <h3 style="margin-top:0;">è¡¨ç¤ºã‚µã‚¤ã‚º</h3>
          <div style="display:flex;flex-direction:column;gap:8px;margin-top:8px">
        <label style="display:flex;align-items:center;gap:8px"><input type="radio" name="vmode" value="small"> å°</label>
        <label style="display:flex;align-items:center;gap:8px"><input type="radio" name="vmode" value="medium"> ä¸­</label>
      </div>
      <div style="display:flex;gap:8px;justify-content:flex-end;margin-top:12px">
        <button id="viewModeCancel" class="small-btn" type="button">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
        <button id="viewModeSave" class="open-btn" type="button">é©ç”¨</button>
      </div>
    </div>
  </div>

      <!-- ä¸€èˆ¬ãƒ¦ãƒ¼ã‚¶ãƒ¼ç”¨è©³ç´°ãƒ¢ãƒ¼ãƒ€ãƒ«ï¼ˆé–²è¦§ã®ã¿ï¼‰ -->
      <div class="modal" id="detailModal" role="dialog" aria-modal="true">
        <div class="panel" role="document" aria-labelledby="detailTitle">
          <h3 id="detailTitle">ãƒ–ãƒƒã‚¯ãƒãƒ¼ã‚¯è©³ç´°</h3>

          <div class="form-row">
            <label>ã‚¿ã‚¤ãƒˆãƒ«</label>
            <div class="detail-value" id="detailTitleText" style="padding:8px 12px;background:rgba(255,255,255,0.05);border-radius:8px;user-select:text;"></div>
          </div>

          <div class="form-row">
            <label>URL</label>
            <div class="detail-value" id="detailUrl" style="padding:8px 12px;background:rgba(255,255,255,0.05);border-radius:8px;word-break:break-all;user-select:text;"></div>
          </div>

          <div class="form-row">
            <label>èª¬æ˜</label>
            <div class="detail-value" id="detailDesc" style="padding:8px 12px;background:rgba(255,255,255,0.05);border-radius:8px;min-height:40px;user-select:text;white-space:pre-wrap;"></div>
          </div>

          <div class="form-row">
            <label>ã‚¿ã‚°</label>
            <div class="detail-value" id="detailTags" style="padding:8px 12px;background:rgba(255,255,255,0.05);border-radius:8px;user-select:text;"></div>
          </div>

          <div style="display:flex;justify-content:center;margin-top:16px;">
            <button id="closeDetailModal" class="small-btn" type="button">é–‰ã˜ã‚‹</button>
          </div>
        </div>
      </div>

      <!-- JSON import/export UI removed -->

  <!-- ãƒ¦ãƒ¼ã‚¶ãƒ¼è¨­å®šãƒ¢ãƒ¼ãƒ€ãƒ« -->
  <div class="modal" id="userSettingsModal" role="dialog" aria-modal="true">
    <div class="panel" role="document" style="max-width:400px;">
      <h3 style="text-align:center;">ğŸ‘¤ ãƒ¦ãƒ¼ã‚¶ãƒ¼è¨­å®š</h3>
      <div style="text-align:center;margin:16px 0;">
        <div class="user-avatar-large" id="userAvatarLarge">ğŸ‘¤</div>
        <input type="file" id="avatarUploadInput" accept="image/*" style="display:none" />
        <button id="uploadAvatarBtn" class="small-btn" style="margin-top:12px;">ğŸ“· ã‚¢ã‚¤ã‚³ãƒ³ã‚’å¤‰æ›´</button>
      </div>
      <div id="loginSection" style="margin-top:16px;">
        <p style="text-align:center;color:var(--muted);font-size:13px;margin-bottom:12px;">Googleã§ãƒ­ã‚°ã‚¤ãƒ³ã™ã‚‹ã¨ãƒ‡ãƒ¼ã‚¿ãŒåŒæœŸã•ã‚Œã¾ã™</p>
        <button id="googleSignInBtn2" class="open-btn" style="width:100%;display:flex;align-items:center;justify-content:center;gap:8px;">
          <img src="https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg" alt="Google" style="width:18px;height:18px;">
          Googleã§ãƒ­ã‚°ã‚¤ãƒ³
        </button>
      </div>
      <div id="logoutSection" style="display:none;margin-top:16px;">
        <p id="loggedInEmail" style="text-align:center;color:var(--muted);font-size:13px;margin-bottom:12px;"></p>
        <button id="signOutBtn2" class="small-btn" style="width:100%;background:#e74c3c;color:#fff;border-color:#e74c3c;">ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ</button>
      </div>
      <!-- è¡¨ç¤ºè¨­å®š: view size ã¨ sort ã‚’ã“ã“ã«ç§»å‹• -->
      <div style="margin-top:12px;">
        <div class="form-row" style="margin-bottom:6px">
          <label style="font-weight:700">è¡¨ç¤ºè¨­å®š</label>
          <div style="display:flex;flex-direction:column;gap:8px;margin-top:8px;">
            <div style="display:flex;align-items:center;gap:8px;">
              <label style="min-width:80px;">è¡¨ç¤ºã‚µã‚¤ã‚º:</label>
              <select id="viewSizeSelect">
                <option value="small">ğŸ” å°</option>
                <option value="medium">ğŸ“‹ ä¸­</option>
              </select>
            </div>
            <div style="display:flex;align-items:center;gap:8px;">
              <label style="min-width:80px;">ä¸¦ã³é †:</label>
              <select id="sortSelect">
                <option value="alpha_en_asc">åå‰é †ï¼ˆæ˜‡é †ï¼‰</option>
                <option value="alpha_en_desc">åå‰é †ï¼ˆé™é †ï¼‰</option>
                <option value="date-new">ğŸ“… æ–°ã—ã„é †</option>
                <option value="date-old">ğŸ“… å¤ã„é †</option>
              </select>
            </div>
          </div>
        </div>
      </div>
      <!-- Appearance: Dark mode toggle -->
      <div style="margin-top:12px;">
        <div class="form-row" style="margin-bottom:6px">
          <label style="font-weight:700">å¤–è¦³</label>
          <div style="display:flex;align-items:center;gap:8px">
            <input type="checkbox" id="darkModeToggle" />
            <label for="darkModeToggle" style="margin:0;">ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰ã‚’æœ‰åŠ¹ã«ã™ã‚‹</label>
          </div>
        </div>
      </div>
      <div style="display:flex;gap:8px;justify-content:center;margin-top:20px;">
        <!-- OGP ãƒ—ãƒ­ã‚­ã‚·è¨­å®š UI ã¯éè¡¨ç¤ºï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ Worker ã‚’åˆ©ç”¨ï¼‰ -->
        <button id="closeUserSettingsModal" class="small-btn">é–‰ã˜ã‚‹</button>
      </div>
    </div>
  </div>

  <!-- Firebase SDKï¼ˆcompatï¼‰: ã“ã‚Œã‚’ä¸€åº¦ã ã‘èª­ã¿è¾¼ã‚€ -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

  <!-- å¤–éƒ¨ã‚¹ã‚¯ãƒªãƒ—ãƒˆæœ¬ä½“ -->
  <script src="linklocal.js" defer></script>

  <script>
  // ã‚ªãƒ¼ãƒŠãƒ¼ã§ã‚ã‚Œã°å¸¸ã«å³ä¸‹ã«FABã‚’è¡¨ç¤ºã™ã‚‹ï¼ˆmobile Safariã®safe-areaè€ƒæ…®ï¼‰
  (function(){
    const fab = document.getElementById('openAdd');
    if(!fab) return;

    function applyVisible(visible){
      try{
        if(visible){
          fab.style.display = 'flex';
          fab.setAttribute('aria-hidden','false');
        }else{
          fab.style.display = 'none';
          fab.setAttribute('aria-hidden','true');
        }
      }catch(e){ /* ignore */ }
    }

    // åˆæœŸã¯éè¡¨ç¤ºã€linklocal.js å´ã§ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•° `isReadOnlyMode` ã‚’è¨­å®šã—ã¾ã™ã€‚
    applyVisible(false);

    // å¤‰åŒ–ã‚’ãƒãƒ¼ãƒªãƒ³ã‚°ã§ç›£è¦–ï¼ˆlinklocal.js ã®å‡¦ç†ãŒå®Œäº†ã—ãŸã‚‰åæ˜ ã•ã‚Œã‚‹ï¼‰
    let last;
    const iv = setInterval(()=>{
      let v;
      try{
        if(typeof isReadOnlyMode === 'boolean') v = isReadOnlyMode; // top-level let ã‚’å‚ç…§
        else if(typeof window.isReadOnlyMode === 'boolean') v = window.isReadOnlyMode; // ã‚‚ã— var ã§å…¬é–‹ã•ã‚Œã¦ã„ã‚‹å ´åˆ
      }catch(e){ v = undefined; }
      if(typeof v === 'boolean' && v !== last){
        last = v;
        // ã‚ªãƒ¼ãƒŠãƒ¼ãªã‚‰ç·¨é›†å¯èƒ½ (= false ã®å ´åˆ) ã¨ã—ã¦è¡¨ç¤º
        applyVisible(!v);
        // å€¤ãŒç¢ºå®šã—ãŸã‚‰ãƒãƒ¼ãƒªãƒ³ã‚°ã¯ä¸è¦
        clearInterval(iv);
      }
    }, 250);

    // ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—: 30ç§’å¾Œã«å¼·åˆ¶åœæ­¢
    setTimeout(()=> clearInterval(iv), 30000);
  })();
  </script>

<!-- Cookie consent banner (inserted by assistant) -->
<style>
  #cookieBanner {
    position:fixed;
    left:16px;
    right:16px;
    bottom:18px;
    z-index:1200;
    background: rgba(15, 184, 191, 0.98);
    color: #fff;
    padding:12px 14px;
    border-radius:12px;
    box-shadow: 0 8px 24px rgba(2,18,22,0.12);
    display:flex;
    gap:12px;
    align-items:center;
    justify-content:space-between;
    max-width:980px;
    margin:0 auto;
    box-sizing:border-box;
    font-size:14px;
  }
  #cookieBanner .msg{flex:1;min-width:0; margin-right:12px; color: #02292c; font-weight:700}
  #cookieBanner .actions{display:flex;gap:8px;align-items:center;flex-shrink:0}
  #cookieBanner .cookie-btn{padding:8px 12px;border-radius:8px;border:none;cursor:pointer;font-weight:700}
  #cookieBanner .cookie-accept{background:#fff;color:var(--text)}
  #cookieBanner .cookie-more{background:transparent;color:#fff;border:1px solid rgba(255,255,255,0.3)}
  @media(max-width:560px){
    #cookieBanner{left:10px;right:10px;padding:10px;flex-direction:column;align-items:flex-start;gap:8px}
    #cookieBanner .actions{align-self:stretch;justify-content:flex-end;width:100%}
    #cookieBanner .msg{font-size:15px;font-weight:700;color:#fff}
    #cookieBanner .cookie-accept{width:110px}
  }
</style>

<div id="cookieBanner" role="region" aria-label="ã‚¯ãƒƒã‚­ãƒ¼ã®åˆ©ç”¨ã«ã¤ã„ã¦" hidden>
<div id="cookieBanner" role="region" aria-label="ã‚¯ãƒƒã‚­ãƒ¼ã®åˆ©ç”¨ã«ã¤ã„ã¦" hidden>
  <div class="msg">å½“ã‚µã‚¤ãƒˆã¯æ­£å¸¸ãªå‹•ä½œã®ãŸã‚ã‚¯ãƒƒã‚­ãƒ¼ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚ç¶šè¡Œã™ã‚‹ã“ã¨ã§åŒæ„ã—ãŸã‚‚ã®ã¨ã¿ãªã—ã¾ã™ã€‚</div>
  <div class="actions">
    <button class="cookie-btn cookie-accept" id="cookieAccept">åŒæ„ã™ã‚‹</button>
  </div>
</div>

<!-- ãƒ†ã‚¹ãƒˆç”¨ã‚³ãƒ¼ãƒ‰ã¯å‰Šé™¤æ¸ˆã¿ -->

<script>
(function(){
  try{
    const BANNER_KEY = 'cookie_consent_v1';
    const banner = document.getElementById('cookieBanner');
    const acceptBtn = document.getElementById('cookieAccept');
    const moreBtn = document.getElementById('cookieMore');

    // localStorageåˆ©ç”¨å¯å¦ã‚’ãƒã‚§ãƒƒã‚¯
    function isStorageAvailable(){
      try{
        const test = '__storage_test__';
        localStorage.setItem(test, test);
        localStorage.removeItem(test);
        return true;
      }catch(e){ return false; }
    }

    function showBanner(){
      if(!banner) return;
      banner.hidden = false;
      banner.style.display = '';
      acceptBtn && acceptBtn.focus();
    }
    function hideBanner(){
      if(!banner) return;
      try{ banner.hidden = true; }catch(e){}
      try{ banner.style.display = 'none'; }catch(e){}
    }

    function hasConsent(){
      if(!isStorageAvailable()) return true; // ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ãŒä½¿ãˆãªã„å ´åˆã¯åŒæ„æ¸ˆã¿ã¨ã¿ãªã™
      try{ return localStorage.getItem(BANNER_KEY) === '1'; }catch(e){ return true; }
    }
    function setConsent(){
      if(!isStorageAvailable()) return;
      try{ localStorage.setItem(BANNER_KEY, '1'); }catch(e){}
    }

    // ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ãŒä½¿ãˆãªã„å ´åˆã¯ãƒãƒŠãƒ¼ã‚’è¡¨ç¤ºã—ãªã„
    if(!isStorageAvailable()){ hideBanner(); }
    else if(!hasConsent()) window.requestAnimationFrame(()=>{ showBanner(); }); 
    else hideBanner();

    // Use both addEventListener and onclick assignment to be robust
    if(acceptBtn){
      acceptBtn.addEventListener('click', onAccept);
      acceptBtn.onclick = onAccept;
    }

    function onAccept(e){
      // persist consent in localStorage only (cookie writing may be blocked by browser/privacy settings)
      try{ setConsent(); }catch(e){}
      try{ hideBanner(); }catch(e){}
      try{ if(banner && banner.parentNode){ banner.parentNode.removeChild(banner); } }catch(e){}
    }

    document.addEventListener('keydown', (e)=>{ if((e.key==='Escape' || e.key==='Esc') && banner && !banner.hidden){ setConsent(); hideBanner(); } });
  }catch(e){ console.warn('cookie banner init error', e); }
})();
</script>

<!-- ãƒ†ã‚¹ãƒˆç”¨ã‚³ãƒ¼ãƒ‰ã¯å‰Šé™¤ã•ã‚Œã¾ã—ãŸ -->

<!-- Bottom Navigation for Mobile -->
<nav class="bottom-nav" id="bottomNav">
  <button class="bottom-nav-btn" id="bottomSearchBtn" type="button">
    <span class="bottom-nav-icon">ğŸ”</span>
    <span class="bottom-nav-label">æ¤œç´¢</span>
  </button>
  <button class="bottom-nav-btn" id="bottomTagsBtn" type="button">
    <span class="bottom-nav-icon">ğŸ·ï¸</span>
    <span class="bottom-nav-label">ã‚¿ã‚°</span>
  </button>
  <button class="bottom-nav-btn" id="bottomAddBtn" type="button">
    <span class="bottom-nav-icon">â•</span>
    <span class="bottom-nav-label">è¿½åŠ </span>
  </button>
</nav>

<!-- Search overlay for mobile bottom nav -->
<div class="search-overlay" id="searchOverlay">
  <div class="search-overlay-content">
    <input type="text" id="mobileSearchInput" placeholder="æ¤œç´¢..." autocomplete="off" />
    <button id="closeSearchOverlay" class="small-btn" type="button">é–‰ã˜ã‚‹</button>
  </div>
</div>

</body>
</html>